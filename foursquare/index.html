<!DOCTYPE html>
<html>
<head>
	<title>Foursquare API</title>
</head>
<body>
	<a href="https://foursquare.com/oauth2/authenticate?client_id=MKQICTVQSVBSMXTUXIMOB2GGVDA2WIJNOJY2XJGBX2G3VD1H&response_type=code&redirect_uri=http://www.sahibjot.me/foursquare/">Go here</a>
	<input type="text" placeholder="What is it?" class="query"/>
	<input type="text" placeholder="Near" class="near" />
	<input type="submit" class="myButton" />
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-alpha1/jquery.min.js"></script>
	<script>
	$(document).ready(function() {
		$.urlParam = function(name){
			var results = new RegExp('[\?&]' + name + '=([^&#]*)').exec(window.location.href);
			return results[1] || 0;
		}
		function hey_buddy(data) {
			console.log('buddy');
		}
		if ($.urlParam('code') !== undefined) {
			console.log($.urlParam('code'));
			var url = 'https://foursquare.com/oauth2/access_token?client_id=MKQICTVQSVBSMXTUXIMOB2GGVDA2WIJNOJY2XJGBX2G3VD1H&client_secret=HFZS2ET2QLKHUL3YRE0T0ANB32PNFSJ2CXAHJZUPNGEATM42&grant_type=authorization_code&redirect_uri=http://www.sahibjot.me/foursquare/&code=' + $.urlParam('code') + '#_=_&callback=';
			$.ajax({
				type: 'GET',
				url: url,
				async: false,
				jsonpCallback: 'jsonCallback',
				contentType: 'application/json',
				dataType: 'jsonp',
				success: function(json) {
					console.log('ya');
				},
				error: function(e) {
					console.log(e);
				}
			});


			//$.ajax('', {client_id: 'MKQICTVQSVBSMXTUXIMOB2GGVDA2WIJNOJY2XJGBX2G3VD1H', client_secret: 'HFZS2ET2QLKHUL3YRE0T0ANB32PNFSJ2CXAHJZUPNGEATM42', grant_type: 'authorization_code', redirect_uri: 'http://www.sahibjot.me/foursquare/', code: $.urlParam('code') + '#_=_'}).done(function(data) {console.log(data);});
		}


		$('.myButton').click(function() {
			var Query = $('.query').val();
			var Near = $('.near').val();
			$.ajax('https://api.foursquare.com/v2/venues/search', {query: Query, near: Near, oauth_token: 'JVE1HCGPFEW0YG4OCYFK053GBDD4MO31OFMHD3TEVPEKKPPW', v: '20150905'})
			.success(function(data) {
				console.log(data);
			});
		});
	});
	</script>
</body>
</html>
